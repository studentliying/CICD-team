# CI/CD 团队作业
### 小组成员：姚子航，应邦豪，徐天强，王鑫伟，励颖 
## 目录
### 1. CI/CD 介绍
### 2. CI/CD 实践
### 3. CI/CD 思考
## 1. CI/CD 介绍
### 1.1 名次解释
&#8194;&#8194; CI: Continuous Integration，即持续集成。

&#8194;&#8194; CD: Continuous Delivery，Continuous Deployment，即持续交付、持续部署。

&#8194;&#8194;构建：将源代码放在一起，并验证软件可以作为一个一致的单元运行的过程；验证活动一般包括编译、测试、审查和部署。

&#8194;&#8194;集成：狭义的集成指代码与代码之间的集成，保证代码合并不冲突；广义的集成指软件各个过程的集成，包括开发、部署、测试等。

### 1.2 持续集成的定义
&#8194;&#8194;持续集成 是一种软件开发实践，即团队开发成员经常集成他们的工作。通常，每个成员每天至少集成一次，也就意味着每天可能发生多次集成。每次集成都通过自动化的构建来验证，从而尽早地发现集成错误。

### 1.3 持续交付与持续部署
&#8194;&#8194;持续交付在持续集成的基础上，将集成后的代码部署到更贴近真实运行环境的「类生产环境」中进行更多的测试。如果代码没有问题，可以继续手动部署到生产环境中。

&#8194;&#8194;持续部署就是把部署到生产环境的过程自动化。

### 1.4 持续集成与持续部署的优点
* 提高软件质量
* 节约时间，缩短项目发布周期
* 便捷部署
* 建立团队开发产品的信心
* 增强项目的可见性
* 解决项目管理的困惑

#### 1.5 持续集成与持续部署的原则
* 维护唯一的代码仓库
* 让构建能够自测
* 每天执行多次构建，每次构建都要生成可发布的产品
* 每次提交都在主线集成的机器上做构建
* 开发人员每天至少向版本控制库提交一次代码

### 1.6 持续集成与持续部署的工具
* Github
* Jenkins
* Tomcat
* Travis CI

## 2. CI/CD 实践

### 2.1 持续集成：搭建Jenkins环境
&#8194;&#8194;&#8194;&#8194;从Jenkins官网https://jenkins.io/下载最新的war包。

&#8194;&#8194;&#8194;&#8194;方法一：将Jenkins作为一个Windows服务，用命令行运行war包启动Jenkins，并为其分配https端口。

&#8194;&#8194;&#8194;&#8194;方法二：基于Web容器（Tomcat）安装，将jenkins.war复制到%TOMCAT_HOME%\webapps
目录下，启动Tomcat，本次搭建采用此方法。

### 2.2 持续集成：利用Jenkins新建任务
* 步骤一：在Jenkins中安装Maven插件，并新建一个Maven项目。Jenkins会利用pom文件，从而大大减轻构建配置。

* 步骤二：在配置页中，源码管理选择Git，填入地址。默认使用master分支。如果需要口令，在Credentials中添加用户名/口令，或者使用SSH Key

* 步骤三：配置构建触发器，定时检查版本库，发现有新的提交就触发构建。这种方式对git、SVN等所有版本管理系统都是通用的。

* 步骤四：配置构建选项，本项目直接使用maven的pom.xml进行构建，需要配置好pom.xml文件路径以及配置参数，这里的参数是跳过test选项。在pom.xml里的build标签添加<defaultGoal> 标签，值为package阶段，这样build结束后才会生成可运行jar文件

* 步骤五：github配置webhook，每当master分支发生变动，merge pull request 或有新的commit，就会将信息push到jenkins平台上，并自动构建。

### 2.3 持续集成：Jenkins任务构建结果
&#8194;&#8194;&#8194;&#8194;S（上次的构建状态），蓝色代表Success，红色代表Failed
&#8194;&#8194;&#8194;&#8194;W（编译晴雨表）：最近五次构建的成功率。

### 2.4 持续集成：持续集成效果演示

### 2.5 持续集成：问题总结
* JDK版本问题
&#8194;&#8194;&#8194;&#8194;Jenkins 似乎对 JDK8 以上的版本存在不兼容的问题，重新安装 JDK8 并在全局系统配置中更改 JDK 配置之后问题解决。

* Maven项目设置
&#8194;&#8194;&#8194;&#8194;Local Maven Repository 应当设置为 Local to workspace。

* BuildTest不通过
&#8194;&#8194;&#8194;&#8194;有时在构建时会出现maventest不通过的情况，可以通过添加Dskiptests参数暂时跳过test解决问题

* pom.xml更改
&#8194;&#8194;&#8194;&#8194;ide生成的pom.xml并没有指定defaultGoal，需要自己在pom.xml中修改

### 2.6 持续部署
&#8194;&#8194;&#8194;&#8194; 本次作业并没有实现自动部署，而是手动部署SpringBoot项目。

&#8194;&#8194;&#8194;&#8194;在jenkins的workspace下，可以在/target目录找到jar包，在命令行输入“java -jar <filename>”运行，显示运行成功。
&#8194;&#8194;&#8194;&#8194;服务地址：47.106.75.68

### 2.7 监控
&#8194;&#8194;&#8194;&#8194;Application的监控使用了阿里巴巴的druid监控组件。提供了SQL监控、Session监控、URL监控等功能，方便了开发者根据监控情况调整项目。














